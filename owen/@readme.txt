Python библиотека для работы с устройствами фирмы Owen (owen.ru) по протоколу ОВЕН

Изначально пытался работать с внешней динамической библиотекой, поставляемой с устройством, но у неё есть ряд ограничений. Например, нельзя по порту, занятому библиотекой, общаться с другими устройствами. Кроме того, как и при работе с любой внешней библиотекой невозможно организовать обработку ошибок или оптимизировать код, скажем по скорости обмена. Поэтому была написана своя библиотека на основе с-реализации протокола, её можно найти в "owen_protocol.c". В моей библиотеке, которая представляет собой библиотеку классов, есть класс для работы с протоколом, есть класс для работы с любым устройством ОВЕН и есть пример специализированного класса для работы с конкретным прибором.

Пример работы с классом протокола:
op = OwenProtocol(address,addrLen)
id=op.name2id('dev')#получаем свертку строкового идентификатора
hash=op.id2hash(id)#получаем хэш параметра

Пример работы с классом прибора:
owen=OwenDevice(None,16)#создаем устройство без указания порта, это значит, что вместо данных будет приходить тестовая строка
result=owen.GetDeviceName()#получаем название устройства, в тестовом режиме будет TPM251

Пример работы с прибором ТРМ251
pidReg=trm251.TRM251(COM,16);#открываем настоящий порт
Temp=pidReg.GetTemperature(1)#получаем температуры с первого датчика

Требования: интерпретатор python, библиотеки pySerial и pyWin32 (под windows), wxPython (для запуска гуёвого примера)

Описание файлов:
Папка TOwen
owen.py     - общий класс для работы с устройствами owen
trm251.py	- пример класса для устройства ТРМ251
owen_protocol.c	- реализация протокола на языке с

Папка TSystem
MySerial.py  	- класс последовательного порта с логированием данных, проходящих через порт. Для своей работы требует класс Serial из пакета pySerial


OwenSample.py		- пример работы с устройством Owen
Trm251SampleConsole.py	- консольный пример работы с ТРМ251
Trm251SampleGUI.py	- пример работы с ТРМ251 с графическим интерфейсом. Для работы требует библиотеку wxPython


